<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate Risk — RiskCalc • ERAg</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Risk — RiskCalc"><meta property="og:description" content="This function estimates the production risk of an experimental treatment compared to the control treatment using time series data.  We suggest applying the ERA.Prepare function to
data before using with this function."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ERAg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/ERA-Explore-and-Analyze.html">ERA-Explore-and-Analyze</a>
    </li>
    <li>
      <a href="../articles/ERA-Introduction.html">ERA-Introduction</a>
    </li>
    <li>
      <a href="../articles/ERA-Search-Protocol.html">ERA-Search-Protocols-Draft</a>
    </li>
    <li>
      <a href="../articles/ERA-Yield-Stability.html">ERA Yield Stability</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate Risk</h1>

    <div class="hidden name"><code>RiskCalc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function estimates the production risk of an experimental treatment compared to the control treatment using time series data.  We suggest applying the <code>ERA.Prepare</code> function to
data before using with this function.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">RiskCalc</span><span class="op">(</span><span class="va">Data</span>, PLevel <span class="op">=</span> <span class="st">"PrName"</span>, Out.Codes <span class="op">=</span> <span class="fl">101</span>, MinYear <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data">Data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A prepared (ERA) dataset, see the <code>ERA.Prepare</code> function.</p></dd>


<dt id="arg-plevel">PLevel<a class="anchor" aria-label="anchor" href="#arg-plevel"></a></dt>
<dd><p>The column name of the variable in <code>Data</code> that describes the practice. Use this parameter to choose different levels of the practice hierarchy. Default = <code>PrName</code> (Practice).</p></dd>


<dt id="arg-out-codes">Out.Codes<a class="anchor" aria-label="anchor" href="#arg-out-codes"></a></dt>
<dd><p>A vector of outcome codes to consider in the analysis. Default = <code>101</code> (Crop Yield).</p></dd>


<dt id="arg-minyear">MinYear<a class="anchor" aria-label="anchor" href="#arg-minyear"></a></dt>
<dd><p>An integer value for the minimum length of a MYO sequence. Sequences with fewer growing season than this number are excluded from analysis. Default = <code>3</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of two data.tables <code>Risk</code> and <code>Risk.Averages</code>.
<code>Risk</code> contains statistics calculated for each value of <code>UID</code> and has the fields:</p><ul><li><p><code>UID</code> = a unique identifier based on the field <code>Outcome</code>,<code>Practice</code>,<code>Practice.Base</code>,<code>Practice.Code</code>,<code>Code</code>,<code>ID</code>,<code>Site.ID</code>,<code>EU</code>,<code>T.Descrip</code>,<code>C.Descrip</code>,<code>T.NI</code>,<code>T.NO</code>,<code>C.NI</code>,<code>C.NO</code>,<code>Tree</code>,<code>Variety</code>,<code>Diversity</code>, and <code>Rep</code>.</p></li>
<li><p><code>N.Years</code>= the number of unique growing seasons reported for each value of <code>UID</code>.</p></li>
<li><p><code>N.Obs</code> = the total number of observation for a value of <code>UID</code>.</p></li>
<li><p><code>Diff.Mean</code> = mean difference between experimental and control treatments (<code>mean(MeanT-MeanC)</code>)</p></li>
<li><p><code>Diff.SD</code> = standard deviation of mean difference (<code>sd(MeanT-MeanC)</code>)</p></li>
<li><p><code>Diff.t.stat</code> = t-statistic of  mean difference (<code>.Mean/(.SD/N.Obs^0.5)</code>)</p></li>
<li><p><code>Diff.p.val</code> = probability of  mean difference being &lt;0   (<code>pt(Diff.t.stat,N.Obs-1,lower.tail = T)</code>)</p></li>
<li><p><code>Mean.C</code> = mean of control treatment</p></li>
<li><p><code>Mean.T</code> = mean of experimental treatment</p></li>
<li><p><code>Mean.T.SD</code> = standard deviation of experimental treatment</p></li>
<li><p><code>Mean.t.stat</code> = t-statistic for <code>MeanT</code> &lt; <code>MeanC</code> (<code>Mean.T-Mean.C)/(Mean.T.SD/N.Obs^0.5</code>)</p></li>
<li><p><code>Mean.p.val</code> = probability of <code>MeanT</code> &lt; <code>MeanC</code>   (<code>pt(Mean.t.stat,N.Obs-1,lower.tail = T)</code>)</p></li>
<li><p><code>N.Obs.Study</code> = number of observations a study (<code>Code</code> column) contributes to a combination of practice x outcome</p></li>
</ul><p><code>Risk.Averages</code> is the data in the <code>Risk</code> table averaged with weighting across practice x outcome combinations. Additional fields are:</p><ul><li><p><code>Mean.Seq.Len</code>= the mean value of <code>Risk$N.Years</code></p></li>
<li><p><code>Median.Seq.Len</code>= the median value of <code>Risk$N.Years</code></p></li>
<li><p><code>N.Studies</code> = the number of studies contributing MYOs</p></li>
<li><p><code>Total.Obs</code>= the total number of observations contributing to MYOs</p></li>
<li><p><code>N.Obs</code>= the total number of MYOs</p></li>
<li><p><code>Diff.p.val.se</code> = the standard error of <code>Risk$Diff.p.val</code></p></li>
<li><p><code>Mean.p.val.se</code> = the standard error of <code>Risk$Mean.p.val</code></p></li>
<li><p><code>Diff.CI95low</code> = lower 95% confidence interval of <code>Diff.p.val</code></p></li>
<li><p><code>Diff.CI95high</code> = upper 95% confidence interval of <code>Diff.p.val</code></p></li>
<li><p><code>Mean.CI95low</code> = lower 95% confidence interval of <code>Mean.p.val</code></p></li>
<li><p><code>Mean.CI95high</code> = upper 95% confidence interval of <code>Mean.p.val</code></p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Method:
We adapted a lower confidence limit (LCL) approach (e.g.  <a href="https://www.cabdirect.org/cabdirect/abstract/19996775299" class="external-link">Hildebrand1996</a>,
<a href="https://doi.org/10.1016/S0167-8809(00)00140-7" class="external-link">Yamoah2000</a>, <a href="https://doi.org/10.3763/ijas.2010.0471" class="external-link">Sirrine2010</a>) to estimate production risk as:</p><ol><li><p><code>Risk.Means</code> = the probability of the mean experimental treatment yielding lower than the control treatment; and</p></li>
<li><p><code>Risk.Diff</code> = the probability of the mean yield difference between experimental and control treatments being less than 0.</p></li>
</ol><p>A minimum of three seasons of yield data from the same experimental treatments are required to calculate risk and this is the default threshold for the analyses presented here.
The minimum number of season for a multi-year observation (MYO) to be included in analyses can be adjusted using the <code>MinYear</code> parameter.</p>
<p>Statistics are reported aggregated to the level of practice hierarchy specified in the <code>PLevel</code> parameter.</p>
<p>Outcomes are analyzed at the subindicator level. Whilst any outcome(s) can be used with this function, it's primary purpose is to analyze productivity outcomes such as crop yield or net returns.</p>
<p>Weightings are applied to mean and error estimates as per the methods described in the <code>ERA.Analyze</code> function.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Peter Steward.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

