<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Peter Steward" />

<meta name="date" content="2021-10-28" />

<title>ERA-Merge-Biophysical</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">ERA-Merge-Biophysical</h1>
<h4 class="author">Peter Steward</h4>
<h4 class="date">2021-10-28</h4>



<p>Please familiarize yourself with the <code>ERA-Climate-Data</code> &amp; <code>ERA-Large-Climate-Datasets</code> vignettes before reading this document.</p>
<p>In this vignette we will be exploring how to connect ERA to soil and seasonal climate datasets.</p>
<div id="prepare-analytical-environment" class="section level3">
<h3>1. Prepare analytical environment</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;pacman&quot;</span>, <span class="at">character.only =</span> <span class="cn">TRUE</span>)){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">&quot;pacman&quot;</span>,<span class="at">dependencies =</span> T)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  required.packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ERAg&quot;</span>,<span class="st">&quot;data.table&quot;</span>,<span class="st">&quot;miceadds&quot;</span>,<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_load</span>(<span class="at">char=</span>required.packages,<span class="at">install =</span> T,<span class="at">character.only =</span> T)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    </span></code></pre></div>
<div id="load-climate-data" class="section level4">
<h4>Load climate data</h4>
<p>In Section 2 of the <code>ERA-Climate-Data</code> vignette we saved the outputs of the <code>ClimateCalc</code> function to a folder <code>ERA Climate Analysis/</code> from which we will load the seasonal climate data we need to merge with ERA.</p>
<p>The output of <code>ClimateCalc</code> is saved in a folder named with a concatenation of the arguments provided to the function, in the <code>ERA-Climate-Data</code> vignette they generate the folder name <code>422814143322303020152010130-3POWCHIFALSE0.6</code>.</p>
<p>This climate analysis is also available from the <code>ERAg</code> git as a piggybacked file called <code>422814143322303020152010130-3POWCHIFALSE0.6.zip</code> see the <code>ERA-Large-Climate-Datasets.Rmd</code> for download instructions.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a directory for the climate analysis</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>ClimDir<span class="ot">&lt;-</span><span class="st">&quot;ERA Climate Analysis/422814143322303020152010130-3POWCHIFALSE0.6/&quot;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(ClimDir)){</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(ClimDir)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Load saved seasonal climate data:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ClimateA<span class="ot">&lt;-</span><span class="fu">load.Rdata2</span>(<span class="st">&quot;ClimStatsA.RData&quot;</span>,<span class="at">path=</span>ClimDir)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ClimateA)</span></code></pre></div>
<p>The <code>ClimateCalc</code> function also saved the processed input ERA dataset which contains the fields we need to link the climate data back to the ERA dataset. Load this dataset:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ERA<span class="ot">&lt;-</span><span class="fu">load.Rdata2</span>(<span class="st">&quot;Data.RData&quot;</span>,<span class="at">path=</span>AnalysisDir)</span></code></pre></div>
</div>
<div id="prepare-isda-soils-data" class="section level4">
<h4>Prepare iSDA Soils Data</h4>
<p><a href="https://www.isda-africa.com/isdasoil/">iSDA soils data</a> are provided for each location in ERA.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Soils<span class="ot">&lt;-</span>ERA_ISDA</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Soils[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Median   Mean   SD</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     1:    200 198.31 2.85</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     2:    192 191.08 4.10</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     3:    200 200.00 0.00</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     4:    200 200.00 0.00</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     5:    181 179.40 4.64</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    ---                   </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 48737:      9   8.33 1.25</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 48738:      6   5.99 0.13</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 48739:      1   1.05 0.38</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 48740:      9   9.39 0.84</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 48741:      6   6.00 0.09</span></span></code></pre></div>
<p>For explanations of the soil variables in the <code>Variables</code> field see the <a href="https://gitlab.com/openlandmap/africa-soil-and-agronomy-data-cube">Africa Soil and Agronomy Data Cube</a> gitlab and/or the publication <a href="https://doi.org/10.1038/s41598-021-85639-y">Hengl, T., Miller, M.A.E., Križan, J. et al. (2021) African soil properties and nutrients mapped at 30 m spatial resolution using two-scale ensemble machine learning. Sci Rep 11, 6130</a>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Soils[,<span class="fu">unique</span>(Variable)]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;bdr_m_30m_0..200cm&quot;             &quot;clay_tot_psa_m_30m_0..20cm&quot;    </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3] &quot;clay_tot_psa_m_30m_20..50cm&quot;    &quot;db_od_m_30m_0..20cm&quot;           </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5] &quot;db_od_m_30m_20..50cm&quot;           &quot;log.al_mehlich3_m_30m_0..20cm&quot; </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7] &quot;log.al_mehlich3_m_30m_20..50cm&quot; &quot;log.c_tot_m_30m_0..20cm&quot;       </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9] &quot;log.c_tot_m_30m_20..50cm&quot;       &quot;log.ca_mehlich3_m_30m_0..20cm&quot; </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11] &quot;log.ca_mehlich3_m_30m_20..50cm&quot; &quot;log.ecec.f_m_30m_0..20cm&quot;      </span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13] &quot;log.ecec.f_m_30m_20..50cm&quot;      &quot;log.fe_mehlich3_m_30m_0..20cm&quot; </span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [15] &quot;log.fe_mehlich3_m_30m_20..50cm&quot; &quot;log.k_mehlich3_m_30m_0..20cm&quot;  </span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [17] &quot;log.k_mehlich3_m_30m_20..50cm&quot;  &quot;log.mg_mehlich3_m_30m_20..50cm&quot;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19] &quot;log.n_tot_ncs_m_30m_0..20cm&quot;    &quot;log.n_tot_ncs_m_30m_20..50cm&quot;  </span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [21] &quot;log.oc_m_30m_0..20cm&quot;           &quot;log.oc_m_30m_20..50cm&quot;         </span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [23] &quot;log.p_mehlich3_m_30m_0..20cm&quot;   &quot;log.p_mehlich3_m_30m_20..50cm&quot; </span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [25] &quot;log.s_mehlich3_m_30m_0..20cm&quot;   &quot;ph_h2o_m_30m_0..20cm&quot;          </span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [27] &quot;ph_h2o_m_30m_20..50cm&quot;          &quot;sand_tot_psa_m_30m_0..20cm&quot;    </span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [29] &quot;sand_tot_psa_m_30m_20..50cm&quot;    &quot;silt_tot_psa_m_30m_0..20cm&quot;    </span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [31] &quot;silt_tot_psa_m_30m_20..50cm&quot;    &quot;texture.class_m_30m_0..20cm&quot;   </span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [33] &quot;texture.class_m_30m_20..50cm&quot;</span></span></code></pre></div>
<p>The soil variable names in <code>Variable</code> are bit a clunky (see above), let’s simplify them by removing everything but the variable code from the name. We want to retain the depth information, so we create fields for upper and lower measurement depths.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Soils[<span class="fu">grepl</span>(<span class="st">&quot;0..200cm&quot;</span>,Variable),Depth.Upper<span class="sc">:</span><span class="er">=</span><span class="dv">0</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>      ][<span class="fu">grepl</span>(<span class="st">&quot;0..200cm&quot;</span>,Variable),Depth.Lower<span class="sc">:</span><span class="er">=</span><span class="dv">200</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>        ][,Variable<span class="sc">:</span><span class="er">=</span><span class="fu">gsub</span>(<span class="st">&quot;_m_30m_0..200cm&quot;</span>,<span class="st">&quot;&quot;</span>,Variable)]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>Soils[<span class="fu">grepl</span>(<span class="st">&quot;0..20cm&quot;</span>,Variable),Depth.Upper<span class="sc">:</span><span class="er">=</span><span class="dv">0</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>      ][<span class="fu">grepl</span>(<span class="st">&quot;0..20cm&quot;</span>,Variable),Depth.Lower<span class="sc">:</span><span class="er">=</span><span class="dv">20</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        ][,Variable<span class="sc">:</span><span class="er">=</span><span class="fu">gsub</span>(<span class="st">&quot;_m_30m_0..20cm&quot;</span>,<span class="st">&quot;&quot;</span>,Variable)]</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>Soils[<span class="fu">grepl</span>(<span class="st">&quot;20..50cm&quot;</span>,Variable),Depth.Upper<span class="sc">:</span><span class="er">=</span><span class="dv">20</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>      ][<span class="fu">grepl</span>(<span class="st">&quot;20..50cm&quot;</span>,Variable),Depth.Lower<span class="sc">:</span><span class="er">=</span><span class="dv">50</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        ][,Variable<span class="sc">:</span><span class="er">=</span><span class="fu">gsub</span>(<span class="st">&quot;_m_30m_20..50cm&quot;</span>,<span class="st">&quot;&quot;</span>,Variable)]</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>Soils[,<span class="fu">unique</span>(Variable)]</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;bdr&quot;             &quot;clay_tot_psa&quot;    &quot;db_od&quot;           &quot;log.al_mehlich3&quot;</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5] &quot;log.c_tot&quot;       &quot;log.ca_mehlich3&quot; &quot;log.ecec.f&quot;      &quot;log.fe_mehlich3&quot;</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9] &quot;log.k_mehlich3&quot;  &quot;log.mg_mehlich3&quot; &quot;log.n_tot_ncs&quot;   &quot;log.oc&quot;         </span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13] &quot;log.p_mehlich3&quot;  &quot;log.s_mehlich3&quot;  &quot;ph_h2o&quot;          &quot;sand_tot_psa&quot;   </span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [17] &quot;silt_tot_psa&quot;    &quot;texture.class&quot;</span></span></code></pre></div>
<p>Two soil depths are provided for many variables, if you want to convert these to a single value the we can use a weighted mean based on soil depths. Alternatively you could provide your own weightings, perhaps you consider upper depths in the soil profile to be more important for crop yields than lower depths. You could also just consider the upper soil profile (in this case 0-20cm) if you feel greater depths are unimportant.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Soils[,Weight<span class="sc">:</span><span class="er">=</span>Depth.Lower<span class="sc">-</span>Depth.Upper]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>Soils<span class="ot">&lt;-</span><span class="fu">unique</span>(Soils[,<span class="fu">list</span>(<span class="at">Median=</span><span class="fu">weighted.mean</span>(Median,Weight),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Mean=</span><span class="fu">weighted.mean</span>(Mean,Weight),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">SD=</span><span class="fu">weighted.mean</span>(SD,Weight),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Mode=</span>Mode[Weight<span class="sc">==</span><span class="fu">max</span>(Weight)]),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">by=</span><span class="fu">list</span>(Variable,Site.Key)])</span></code></pre></div>
<p>The <code>Soil</code> data.table is in long form, if we are to merge with an ERA dataset we will need to cast it to wide form where each site occupies a single row and each column is a soil variable x statistic.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Soils)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Variable&quot; &quot;Site.Key&quot; &quot;Median&quot;   &quot;Mean&quot;     &quot;SD&quot;       &quot;Mode&quot;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>Soils<span class="ot">&lt;-</span><span class="fu">dcast</span>(Soils,Site.Key<span class="sc">~</span>Variable,<span class="at">value.var =</span> <span class="fu">c</span>(<span class="st">&quot;Median&quot;</span>,<span class="st">&quot;Mean&quot;</span>,<span class="st">&quot;SD&quot;</span>,<span class="st">&quot;Mode&quot;</span>))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Soils)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;Site.Key&quot;               &quot;Median_bdr&quot;             &quot;Median_clay_tot_psa&quot;   </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4] &quot;Median_db_od&quot;           &quot;Median_log.al_mehlich3&quot; &quot;Median_log.c_tot&quot;      </span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7] &quot;Median_log.ca_mehlich3&quot; &quot;Median_log.ecec.f&quot;      &quot;Median_log.fe_mehlich3&quot;</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10] &quot;Median_log.k_mehlich3&quot;  &quot;Median_log.mg_mehlich3&quot; &quot;Median_log.n_tot_ncs&quot;  </span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13] &quot;Median_log.oc&quot;          &quot;Median_log.p_mehlich3&quot;  &quot;Median_log.s_mehlich3&quot; </span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [16] &quot;Median_ph_h2o&quot;          &quot;Median_sand_tot_psa&quot;    &quot;Median_silt_tot_psa&quot;   </span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19] &quot;Median_texture.class&quot;   &quot;Mean_bdr&quot;               &quot;Mean_clay_tot_psa&quot;     </span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [22] &quot;Mean_db_od&quot;             &quot;Mean_log.al_mehlich3&quot;   &quot;Mean_log.c_tot&quot;        </span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [25] &quot;Mean_log.ca_mehlich3&quot;   &quot;Mean_log.ecec.f&quot;        &quot;Mean_log.fe_mehlich3&quot;  </span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [28] &quot;Mean_log.k_mehlich3&quot;    &quot;Mean_log.mg_mehlich3&quot;   &quot;Mean_log.n_tot_ncs&quot;    </span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [31] &quot;Mean_log.oc&quot;            &quot;Mean_log.p_mehlich3&quot;    &quot;Mean_log.s_mehlich3&quot;   </span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [34] &quot;Mean_ph_h2o&quot;            &quot;Mean_sand_tot_psa&quot;      &quot;Mean_silt_tot_psa&quot;     </span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [37] &quot;Mean_texture.class&quot;     &quot;SD_bdr&quot;                 &quot;SD_clay_tot_psa&quot;       </span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [40] &quot;SD_db_od&quot;               &quot;SD_log.al_mehlich3&quot;     &quot;SD_log.c_tot&quot;          </span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [43] &quot;SD_log.ca_mehlich3&quot;     &quot;SD_log.ecec.f&quot;          &quot;SD_log.fe_mehlich3&quot;    </span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [46] &quot;SD_log.k_mehlich3&quot;      &quot;SD_log.mg_mehlich3&quot;     &quot;SD_log.n_tot_ncs&quot;      </span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [49] &quot;SD_log.oc&quot;              &quot;SD_log.p_mehlich3&quot;      &quot;SD_log.s_mehlich3&quot;     </span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [52] &quot;SD_ph_h2o&quot;              &quot;SD_sand_tot_psa&quot;        &quot;SD_silt_tot_psa&quot;       </span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [55] &quot;SD_texture.class&quot;       &quot;Mode_bdr&quot;               &quot;Mode_clay_tot_psa&quot;     </span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [58] &quot;Mode_db_od&quot;             &quot;Mode_log.al_mehlich3&quot;   &quot;Mode_log.c_tot&quot;        </span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [61] &quot;Mode_log.ca_mehlich3&quot;   &quot;Mode_log.ecec.f&quot;        &quot;Mode_log.fe_mehlich3&quot;  </span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [64] &quot;Mode_log.k_mehlich3&quot;    &quot;Mode_log.mg_mehlich3&quot;   &quot;Mode_log.n_tot_ncs&quot;    </span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [67] &quot;Mode_log.oc&quot;            &quot;Mode_log.p_mehlich3&quot;    &quot;Mode_log.s_mehlich3&quot;   </span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [70] &quot;Mode_ph_h2o&quot;            &quot;Mode_sand_tot_psa&quot;      &quot;Mode_silt_tot_psa&quot;     </span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [73] &quot;Mode_texture.class&quot;</span></span></code></pre></div>
</div>
</div>
<div id="merge-climate-isda-soil-variables-with-era" class="section level3">
<h3>2. Merge climate &amp; iSDA soil variables with ERA</h3>
<p>The planting date used to estimate seasonal climate by the <code>CalcClimate</code> function is called <code>P.Date.Merge</code> in the processed ERA dataset and <code>PD.Used</code> in the <code>ClimateA[[&quot;Observed&quot;]]</code> data. We use this field in combination with the location <code>Site.Key</code> and crop <code>EU</code> fields to match the climate data to ERA.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Clim.Data<span class="ot">&lt;-</span>ClimateA[[<span class="st">&quot;Observed&quot;</span>]]</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate location, crop codes and planting date fields</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>Clim.Data[,MCode<span class="sc">:</span><span class="er">=</span><span class="fu">paste</span>(ID,EU,PD.Used,<span class="at">sep=</span><span class="st">&quot;|&quot;</span>)]</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>ERA[,MCode<span class="sc">:</span><span class="er">=</span><span class="fu">paste</span>(Site.Key,EU,P.Date.Merge,<span class="at">sep=</span><span class="st">&quot;|&quot;</span>)]</span></code></pre></div>
<p>To estimate seasonal deviance for the variables in <code>ClimateA[[&quot;Observed&quot;]]</code> we will need to match these data to the long-term averages in the <code>ClimateA[[&quot;LongTerm&quot;]][[&quot;LT.Clim.Avg&quot;]]</code> data.table. As there are no planting dates in the long-term average data we use growing season to match datasets.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>LTAvg.Clim.Data<span class="ot">&lt;-</span>ClimateA[[<span class="st">&quot;LongTerm&quot;</span>]][[<span class="st">&quot;LT.Clim.Avg&quot;</span>]]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate location, crop codes and season fields</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>LTAvg.Clim.Data[,MCode.LT<span class="sc">:</span><span class="er">=</span><span class="fu">paste</span>(ID,EU,Season)]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>Clim.Data[,MCode.LT<span class="sc">:</span><span class="er">=</span><span class="fu">paste</span>(ID,EU,Season)]</span></code></pre></div>
<p>Now that we have made a key field, we use an lapply to append climate and soil data to ERA making a list entry for each value of <code>W.Name</code> in <code>Clim.Data</code>. <code>W.Name</code> indicates a calculation window for climate stats. Default values of <code>W.Name</code> are <code>Data</code> or <code>EcoCrop</code>, the former uses a season length based on reported or data estimated harvest dates the latter uses EcoCrop to estimate season length. Additional <code>W.Name</code> values present are custom season start and end dates supplied to <code>CalcClimate</code>.</p>
<p>Note that the <code>ClimateA[[&quot;LongTerm&quot;]]</code> data are not directly comparable to the <code>Observed</code> data as they are usually derived from planting dates estimated using rainfall data. Whereas the <code>Observed</code> dataset typically uses reported planting and harvest dates to define a growing season. Despite methodological differences we consider the long-term average climate variables estimated from rainfall to be the best data available and can see no-other obvious pathway to obtaining better data on season deviance from “typical” conditions.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Merge Climate <span class="sc">&amp;</span> Soil Data with ERA <span class="do">####</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ERA.Clim.Soil<span class="ot">&lt;-</span><span class="fu">lapply</span>(Clim.Data[,<span class="fu">unique</span>(W.Name)],<span class="at">FUN=</span><span class="cf">function</span>(X){</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset seasonal climate data to calculation window X</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  CData<span class="ot">&lt;-</span>Clim.Data[W.Name<span class="sc">==</span>X]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset long-term climate averages to calculation window X</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  LT.Clim.Data<span class="ot">&lt;-</span>LTAvg.Clim.Data[W.Name<span class="sc">==</span>X]</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset long-term climate averages for mean and median variables</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  LT.Clim.Data.Mean<span class="ot">&lt;-</span>LT.Clim.Data[Variable<span class="sc">==</span><span class="st">&quot;Mean&quot;</span>]</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  LT.Clim.Data.Median<span class="ot">&lt;-</span>LT.Clim.Data[Variable<span class="sc">==</span><span class="st">&quot;Median&quot;</span>]</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Male an object containing the column names of climate variables for which we wish to calculate deviance</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  Cols<span class="ot">&lt;-</span><span class="fu">colnames</span>(CData[,<span class="sc">!</span><span class="fu">c</span>(<span class="st">&quot;Tmax.sd&quot;</span>,<span class="st">&quot;Tmean.sd&quot;</span>,<span class="st">&quot;PD.Used&quot;</span>,<span class="st">&quot;W.Start&quot;</span>,<span class="st">&quot;W.End&quot;</span>,<span class="st">&quot;W.Name&quot;</span>,<span class="st">&quot;ID&quot;</span>,<span class="st">&quot;M.Year&quot;</span>,<span class="st">&quot;Season&quot;</span>,<span class="st">&quot;MCode&quot;</span>,<span class="st">&quot;MCode.LT&quot;</span>,<span class="st">&quot;EU&quot;</span>,<span class="st">&quot;ETo.NA&quot;</span>)])</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subtract long term average climate from the observed seasonal climate</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  Mean.Diff<span class="ot">&lt;-</span>CData[,..Cols]<span class="sc">-</span>LT.Clim.Data.Mean[<span class="fu">match</span>(CData[,MCode.LT],LT.Clim.Data.Mean[,MCode.LT])][,..Cols]</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  Median.Diff<span class="ot">&lt;-</span>CData[,..Cols]<span class="sc">-</span>LT.Clim.Data.Median[<span class="fu">match</span>(CData[,MCode.LT],LT.Clim.Data.Median[,MCode.LT])][,..Cols]</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rename columns to reflect they are now deviance from long-term mean or median values</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(Mean.Diff)<span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="fu">colnames</span>(Mean.Diff),<span class="st">&quot;.Dev.Mean&quot;</span>)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(Median.Diff)<span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="fu">colnames</span>(Median.Diff),<span class="st">&quot;.Dev.Median&quot;</span>)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join seasonal climate with deviance from long-term average tables</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  CData<span class="ot">&lt;-</span><span class="fu">cbind</span>(CData,Mean.Diff,Median.Diff)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Match soils data to ERA using Site.Key field</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  SoilData<span class="ot">&lt;-</span>Soils[<span class="fu">match</span>(ERA[,Site.Key],Site.Key)]</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join ERA, Climate and Soils datasets removing any duplicated columns</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(ERA, </span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>        CData[<span class="fu">match</span>(ERA<span class="sc">$</span>MCode,MCode),<span class="sc">!</span><span class="fu">c</span>(<span class="st">&quot;MCode&quot;</span>,<span class="st">&quot;EU&quot;</span>,<span class="st">&quot;ID&quot;</span>)], </span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>        SoilData[,<span class="sc">!</span><span class="st">&quot;Site.Key&quot;</span>])</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Name list levels</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ERA.Clim.Soil)<span class="ot">&lt;-</span><span class="fu">unique</span>(Clim.Data<span class="sc">$</span>W.Name)</span></code></pre></div>
<p>We now have an ERA data.table for each level of <code>W.Name</code> with a large number of climate and soil fields appended. See the <code>?ClimateCalc</code> documentation for explantions of the different climate fields.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ERA.Clim.Soil)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Data&quot;       &quot;EcoCrop&quot;    &quot;Plant.0-30&quot;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>ERA.Clim.Soil[[<span class="st">&quot;EcoCrop&quot;</span>]][<span class="sc">!</span><span class="fu">is.na</span>(ETo.sum)][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">30</span>)]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Index   Code  Author Date Journal                       DOI Elevation</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:    88 NN0002 Gigou J 2009 EXP AGR 10.1017/s0014479709990421      1000</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:   129 NN0002 Gigou J 2009 EXP AGR 10.1017/s0014479709990421       400</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Country ISO.3166.1.alpha.3 Site.Type             Site.ID  MAT  MAP     TAP</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:  Guinea                GIN   Station          Bareng ARS &lt;NA&gt; 1700 1522.11</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:  Guinea                GIN   Station CRRAB Bordo, Kankan &lt;NA&gt; 1500 1395.28</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     MSP TSP Soil.Type Soil.Classification Soil.Texture SOC SOC.Unit SOC.Depth</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1: &lt;NA&gt;  NA ferralsol                 FAO         clay 1.8        %        NA</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2: &lt;NA&gt;  NA  cambisol                 FAO   sandy loam 0.5        %        NA</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Soil.pH Soil.pH.Method Plant.Start  Plant.End Harvest.Start Harvest.End Rep</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:     4.5            H2O  2007-07-13 2007-07-13    2007-10-15  2007-10-15   3</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:     5.0            H2O  2007-07-09 2007-07-09    2007-10-06  2007-10-07   3</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Plot.Size                        CID C.Descrip C.NI C.NO</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:        15 T0.T1.T2.T3.T4.T5.T6.T7.T8      no N    0     </span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:        15                         T0  0N 0P 0K    0     </span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                   TID T.Descrip T.NI T.NO Diversity</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1: T9.T10.T11.T12.T13.T14.T15.T16.T17       15N   15               </span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                                T18 30N 0P 0K   30               </span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Variety Tree Duration M.Year M.Year.Start M.Year.End Season.Start</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1: Locale de Niatia             1   2007         2007       2007           NA</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2: Locale de Niatia             1   2007         2007       2007           NA</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Season.End EU Outcode Units   MeanC   MeanT Upper Lower      DataLoc</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:         NA c6     101 Mg/ha 1.43000 1.61000    NA    NA        Tab 5</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:         NA c6     101 Mg/ha 1.03442 1.01306    NA    NA Fig 3a.3b.3c</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    USD2010.C USD2010.T MeanFlip T.Feed.Source C.Feed.Source Species</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:        NA        NA        N                                    </span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:        NA        NA        N                                    </span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Partial.Outcome.Name Partial.Outcome.Code Analysis.Function Version</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                                                        &lt;NA&gt;    2018</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                                                        &lt;NA&gt;    2018</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Mulch.Code    C1 C2  C3 C4    C5 C6 C7 C8 C9 C10 C11 C12 C13  T1 T2  T3 T4</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:       &lt;NA&gt; h66.2 h6 h55 h2 h10.1                             b23 h2 h55 h6</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:       &lt;NA&gt; h66.2 h6 h55 h2 h10.1                             b23 h2 h55 h6</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       T5 T6 T7 T8 T9 T10 T11 T12 T13   ID obs_count out_count Lat Lon</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1: h66.2                             1619       105         2  NA  NA</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2: h66.2                             1619       105         2  NA  NA</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             yi        pc plist base.list EUlist   Out.Pillar Out.SubPillar</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:  0.11855973 12.587413   b23               c6 Productivity         Yield</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2: -0.02086543 -2.064925   b23               c6 Productivity         Yield</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Out.Ind Out.SubInd Out.SubInd.S Out.Pillar.Code Out.SubPillar.Code</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1: Product Yield Crop Yield   Crop Yield    Productivity                 Yi</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2: Product Yield Crop Yield   Crop Yield    Productivity                 Yi</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Out.Ind.Code Out.SubInd.Code   SubPrName               PrName</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:           PY             CrY Inputs Urea Inorganic Fertilizer</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:           PY             CrY Inputs Urea Inorganic Fertilizer</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  Theme SubPrName.Code PrName.Code          Theme.Code</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1: Nutrient Management          IF+Ur          IF Nutrient Management</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2: Nutrient Management          IF+Ur          IF Nutrient Management</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    SubPrName.Base PrName.Base Theme.Base SubPrName.Base.Code PrName.Base.Code</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                                                                           </span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                                                                           </span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Theme.Base.Code Product Product.Type Product.Subtype Product.Simple</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                   Fonio        Plant         Cereals          Fonio</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                   Fonio        Plant         Cereals          Fonio</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Product.Type.Code Product.Subtype.Code Product.Simple.Code Latitude</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:             Plant                   Ce                 Fon  11.1555</span></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:             Plant                   Ce                 Fon  10.3671</span></span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Longitude Buffer              Site.Key   AEZ16simple                  AEZ16</span></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:  -12.5285    400 11.1555 -12.5285 B400 Warm.Subhumid Tropic - warm/subhumid</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:   -9.3355    500  10.3671 -9.3355 B500 Warm.Subhumid Tropic - warm/subhumid</span></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         AEZ5 Mean.Annual.Precip Mean.Annual.Temp      CLY      SLT      SND</span></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1: Sub-Humid           1667.237           25.012 29.66667 32.58333 37.88889</span></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2: Sub-Humid           1487.649           25.991 22.75000 22.20513 55.13462</span></span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    M.Year.Code Altitude.DEM Altitude       species Topt.low Topt.high Tlow</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:        &lt;NA&gt;      1003.53     1000 Digitaria sp.     24.2      31.4 11.4</span></span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:        &lt;NA&gt;       375.25      400 Digitaria sp.     24.2      31.4 11.4</span></span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Thigh cycle_min cycle_max Data.PS.Date Data.PE.Date Data.Date.Acc     LatLon</span></span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:  36.8  44.54545  85.45455         &lt;NA&gt;         &lt;NA&gt;          &lt;NA&gt; 11.2 -12.5</span></span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:  36.8  44.54545  85.45455         &lt;NA&gt;         &lt;NA&gt;          &lt;NA&gt;  10.4 -9.3</span></span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    SLen Data.SLen.Acc Data.SLen Season Rain.Start.End UnC.CHIRPS.P.Date  PDiff</span></span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1: 94.0          &lt;NA&gt;        NA   &lt;NA&gt;             NA              &lt;NA&gt; 0 days</span></span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2: 89.5          &lt;NA&gt;        NA   &lt;NA&gt;             NA              &lt;NA&gt; 0 days</span></span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    H.Diff P.Date.Merge SLen.Merge SLen.EcoCrop</span></span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1: 0 days   2007-07-13       94.0           65</span></span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2: 1 days   2007-07-09       89.5           65</span></span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                  MCode GDDlow GDDopt GDDhigh GDDmax</span></span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1: 11.1555 -12.5285 B400|c6|2007-07-13 878.03 126.15     0.0      0</span></span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:  10.3671 -9.3355 B500|c6|2007-07-09 883.20 299.87     5.9      0</span></span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.Days.L.0 Rain.Days.L.1 Rain.Days.L.5 Rain.Max.RSeq.0 Rain.Max.RSeq.0.1</span></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:          0.30          0.30          0.33               3                 3</span></span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:          0.51          0.51          0.55               4                 4</span></span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.Max.RSeq.1 Rain.Max.RSeq.5 Rain.N.RSeq.T0.D7 Rain.N.RSeq.T1.D7</span></span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:               3               3                 0                 0</span></span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:               4               4                 0                 0</span></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.N.RSeq.T5.D7 Rain.N.RSeq.T0.D14 Rain.N.RSeq.T1.D14 Rain.N.RSeq.T5.D14</span></span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                 0                  0                  0                  0</span></span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                 0                  0                  0                  0</span></span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.N.RSeq.T0.D21 Rain.N.RSeq.T1.D21 Rain.N.RSeq.T5.D21 Rain.sum ETo.sum</span></span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                  0                  0                  0   733.37  213.82</span></span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                  0                  0                  0   613.51  251.35</span></span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    ETo.NA WBalance Tmax.mean  Tmax.sd Tmean.mean  Tmean.sd    PD.Used W.Start</span></span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:      0   519.55  26.15130 1.512316   22.68565 0.8125423 2007-07-13      -3</span></span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:      0   362.16  28.85899 1.894796   24.55522 1.1026114 2007-07-09      -3</span></span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    W.End  W.Name M.Year Season                  MCode.LT GDDlow.Dev.Mean</span></span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:    65 EcoCrop   2007        11.1555 -12.5285 B400 c6           -3.362</span></span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:    65 EcoCrop   2007         10.3671 -9.3355 B500 c6            0.109</span></span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    GDDopt.Dev.Mean GDDhigh.Dev.Mean GDDmax.Dev.Mean Rain.Days.L.0.Dev.Mean</span></span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:         -98.032           -7.281          -0.022                  0.026</span></span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:         -43.948          -28.517          -0.767                  0.040</span></span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.Days.L.1.Dev.Mean Rain.Days.L.5.Dev.Mean Rain.Max.RSeq.0.Dev.Mean</span></span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                  0.026                  0.006                   -0.556</span></span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                  0.040                  0.049                   -0.407</span></span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.Max.RSeq.0.1.Dev.Mean Rain.Max.RSeq.1.Dev.Mean Rain.Max.RSeq.5.Dev.Mean</span></span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                     -0.556                   -0.556                   -0.852</span></span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                     -0.407                   -0.407                   -0.741</span></span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.N.RSeq.T0.D7.Dev.Mean Rain.N.RSeq.T1.D7.Dev.Mean</span></span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                      0.000                      0.000</span></span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                     -0.037                     -0.037</span></span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.N.RSeq.T5.D7.Dev.Mean Rain.N.RSeq.T0.D14.Dev.Mean</span></span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                      0.000                           0</span></span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                     -0.037                           0</span></span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.N.RSeq.T1.D14.Dev.Mean Rain.N.RSeq.T5.D14.Dev.Mean</span></span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                           0                           0</span></span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                           0                           0</span></span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.N.RSeq.T0.D21.Dev.Mean Rain.N.RSeq.T1.D21.Dev.Mean</span></span>
<span id="cb13-120"><a href="#cb13-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                           0                           0</span></span>
<span id="cb13-121"><a href="#cb13-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                           0                           0</span></span>
<span id="cb13-122"><a href="#cb13-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.N.RSeq.T5.D21.Dev.Mean Rain.sum.Dev.Mean ETo.sum.Dev.Mean</span></span>
<span id="cb13-123"><a href="#cb13-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                           0            16.059          -32.510</span></span>
<span id="cb13-124"><a href="#cb13-124" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                           0            39.772          -27.344</span></span>
<span id="cb13-125"><a href="#cb13-125" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    WBalance.Dev.Mean Tmax.mean.Dev.Mean Tmean.mean.Dev.Mean GDDlow.Dev.Median</span></span>
<span id="cb13-126"><a href="#cb13-126" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:            48.570          -1.596696          -0.9713478             -3.84</span></span>
<span id="cb13-127"><a href="#cb13-127" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:            67.116          -1.071014          -0.8567826              0.00</span></span>
<span id="cb13-128"><a href="#cb13-128" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    GDDopt.Dev.Median GDDhigh.Dev.Median GDDmax.Dev.Median</span></span>
<span id="cb13-129"><a href="#cb13-129" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:            -77.80              -2.73                 0</span></span>
<span id="cb13-130"><a href="#cb13-130" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:            -24.61              -8.37                 0</span></span>
<span id="cb13-131"><a href="#cb13-131" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.Days.L.0.Dev.Median Rain.Days.L.1.Dev.Median Rain.Days.L.5.Dev.Median</span></span>
<span id="cb13-132"><a href="#cb13-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                     0.01                     0.01                     0.00</span></span>
<span id="cb13-133"><a href="#cb13-133" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                     0.03                     0.03                     0.06</span></span>
<span id="cb13-134"><a href="#cb13-134" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.Max.RSeq.0.Dev.Median Rain.Max.RSeq.0.1.Dev.Median</span></span>
<span id="cb13-135"><a href="#cb13-135" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                          0                            0</span></span>
<span id="cb13-136"><a href="#cb13-136" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                          0                            0</span></span>
<span id="cb13-137"><a href="#cb13-137" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.Max.RSeq.1.Dev.Median Rain.Max.RSeq.5.Dev.Median</span></span>
<span id="cb13-138"><a href="#cb13-138" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                          0                         -1</span></span>
<span id="cb13-139"><a href="#cb13-139" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                          0                          0</span></span>
<span id="cb13-140"><a href="#cb13-140" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.N.RSeq.T0.D7.Dev.Median Rain.N.RSeq.T1.D7.Dev.Median</span></span>
<span id="cb13-141"><a href="#cb13-141" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                            0                            0</span></span>
<span id="cb13-142"><a href="#cb13-142" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                            0                            0</span></span>
<span id="cb13-143"><a href="#cb13-143" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.N.RSeq.T5.D7.Dev.Median Rain.N.RSeq.T0.D14.Dev.Median</span></span>
<span id="cb13-144"><a href="#cb13-144" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                            0                             0</span></span>
<span id="cb13-145"><a href="#cb13-145" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                            0                             0</span></span>
<span id="cb13-146"><a href="#cb13-146" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.N.RSeq.T1.D14.Dev.Median Rain.N.RSeq.T5.D14.Dev.Median</span></span>
<span id="cb13-147"><a href="#cb13-147" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                             0                             0</span></span>
<span id="cb13-148"><a href="#cb13-148" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                             0                             0</span></span>
<span id="cb13-149"><a href="#cb13-149" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.N.RSeq.T0.D21.Dev.Median Rain.N.RSeq.T1.D21.Dev.Median</span></span>
<span id="cb13-150"><a href="#cb13-150" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                             0                             0</span></span>
<span id="cb13-151"><a href="#cb13-151" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                             0                             0</span></span>
<span id="cb13-152"><a href="#cb13-152" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Rain.N.RSeq.T5.D21.Dev.Median Rain.sum.Dev.Median ETo.sum.Dev.Median</span></span>
<span id="cb13-153"><a href="#cb13-153" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                             0                7.98             -31.86</span></span>
<span id="cb13-154"><a href="#cb13-154" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                             0               33.87             -18.17</span></span>
<span id="cb13-155"><a href="#cb13-155" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    WBalance.Dev.Median Tmax.mean.Dev.Median Tmean.mean.Dev.Median Median_bdr</span></span>
<span id="cb13-156"><a href="#cb13-156" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:               52.37           -1.3566957            -0.8813478        200</span></span>
<span id="cb13-157"><a href="#cb13-157" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:               63.85           -0.4390145            -0.5807826        200</span></span>
<span id="cb13-158"><a href="#cb13-158" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Median_clay_tot_psa Median_db_od Median_log.al_mehlich3 Median_log.c_tot</span></span>
<span id="cb13-159"><a href="#cb13-159" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                31.0        124.6                   46.4             28.2</span></span>
<span id="cb13-160"><a href="#cb13-160" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                22.8        136.6                   52.0             27.8</span></span>
<span id="cb13-161"><a href="#cb13-161" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Median_log.ca_mehlich3 Median_log.ecec.f Median_log.fe_mehlich3</span></span>
<span id="cb13-162"><a href="#cb13-162" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                   62.8              25.6                   36.8</span></span>
<span id="cb13-163"><a href="#cb13-163" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                   59.0              25.6                   37.6</span></span>
<span id="cb13-164"><a href="#cb13-164" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Median_log.k_mehlich3 Median_log.mg_mehlich3 Median_log.n_tot_ncs</span></span>
<span id="cb13-165"><a href="#cb13-165" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                  44.8                     51                 62.2</span></span>
<span id="cb13-166"><a href="#cb13-166" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                  41.4                     45                 52.2</span></span>
<span id="cb13-167"><a href="#cb13-167" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Median_log.oc Median_log.p_mehlich3 Median_log.s_mehlich3 Median_ph_h2o</span></span>
<span id="cb13-168"><a href="#cb13-168" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:            23                  19.6                    32            56</span></span>
<span id="cb13-169"><a href="#cb13-169" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:            18                  17.2                    19            57</span></span>
<span id="cb13-170"><a href="#cb13-170" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Median_sand_tot_psa Median_silt_tot_psa Median_texture.class Mean_bdr</span></span>
<span id="cb13-171"><a href="#cb13-171" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                53.6                21.4                    6      200</span></span>
<span id="cb13-172"><a href="#cb13-172" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                55.6                20.0                    6      200</span></span>
<span id="cb13-173"><a href="#cb13-173" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Mean_clay_tot_psa Mean_db_od Mean_log.al_mehlich3 Mean_log.c_tot</span></span>
<span id="cb13-174"><a href="#cb13-174" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:             30.48    124.620               46.336         28.622</span></span>
<span id="cb13-175"><a href="#cb13-175" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:             23.61    136.818               51.746         27.596</span></span>
<span id="cb13-176"><a href="#cb13-176" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Mean_log.ca_mehlich3 Mean_log.ecec.f Mean_log.fe_mehlich3</span></span>
<span id="cb13-177"><a href="#cb13-177" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:               62.750          25.908               36.474</span></span>
<span id="cb13-178"><a href="#cb13-178" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:               58.908          25.574               37.474</span></span>
<span id="cb13-179"><a href="#cb13-179" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Mean_log.k_mehlich3 Mean_log.mg_mehlich3 Mean_log.n_tot_ncs Mean_log.oc</span></span>
<span id="cb13-180"><a href="#cb13-180" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:              44.778                51.01             62.154      23.040</span></span>
<span id="cb13-181"><a href="#cb13-181" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:              41.266                45.24             52.546      18.374</span></span>
<span id="cb13-182"><a href="#cb13-182" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Mean_log.p_mehlich3 Mean_log.s_mehlich3 Mean_ph_h2o Mean_sand_tot_psa</span></span>
<span id="cb13-183"><a href="#cb13-183" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:              19.700               31.84      56.196            53.158</span></span>
<span id="cb13-184"><a href="#cb13-184" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:              17.072               18.76      56.990            55.444</span></span>
<span id="cb13-185"><a href="#cb13-185" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Mean_silt_tot_psa Mean_texture.class SD_bdr SD_clay_tot_psa SD_db_od</span></span>
<span id="cb13-186"><a href="#cb13-186" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:            21.270              5.808      0           1.618    1.384</span></span>
<span id="cb13-187"><a href="#cb13-187" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:            19.864              6.368      0           2.906    2.646</span></span>
<span id="cb13-188"><a href="#cb13-188" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    SD_log.al_mehlich3 SD_log.c_tot SD_log.ca_mehlich3 SD_log.ecec.f</span></span>
<span id="cb13-189"><a href="#cb13-189" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:              0.430        1.234              0.878         0.676</span></span>
<span id="cb13-190"><a href="#cb13-190" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:              0.594        1.492              1.436         1.310</span></span>
<span id="cb13-191"><a href="#cb13-191" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    SD_log.fe_mehlich3 SD_log.k_mehlich3 SD_log.mg_mehlich3 SD_log.n_tot_ncs</span></span>
<span id="cb13-192"><a href="#cb13-192" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:              0.522             0.644               0.85            2.164</span></span>
<span id="cb13-193"><a href="#cb13-193" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:              0.804             0.772               1.41            3.494</span></span>
<span id="cb13-194"><a href="#cb13-194" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    SD_log.oc SD_log.p_mehlich3 SD_log.s_mehlich3 SD_ph_h2o SD_sand_tot_psa</span></span>
<span id="cb13-195"><a href="#cb13-195" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:     0.676             0.552              2.63     0.546           1.780</span></span>
<span id="cb13-196"><a href="#cb13-196" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:     0.936             0.670              0.73     1.034           2.438</span></span>
<span id="cb13-197"><a href="#cb13-197" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    SD_silt_tot_psa SD_texture.class Mode_bdr Mode_clay_tot_psa Mode_db_od</span></span>
<span id="cb13-198"><a href="#cb13-198" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:           0.746            0.450      200                33        125</span></span>
<span id="cb13-199"><a href="#cb13-199" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:           1.294            0.782      200                23        137</span></span>
<span id="cb13-200"><a href="#cb13-200" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Mode_log.al_mehlich3 Mode_log.c_tot Mode_log.ca_mehlich3 Mode_log.ecec.f</span></span>
<span id="cb13-201"><a href="#cb13-201" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                   46             27                   62              26</span></span>
<span id="cb13-202"><a href="#cb13-202" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                   52             27                   58              25</span></span>
<span id="cb13-203"><a href="#cb13-203" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Mode_log.fe_mehlich3 Mode_log.k_mehlich3 Mode_log.mg_mehlich3</span></span>
<span id="cb13-204"><a href="#cb13-204" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                   34                  44                   51</span></span>
<span id="cb13-205"><a href="#cb13-205" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                   34                  41                   45</span></span>
<span id="cb13-206"><a href="#cb13-206" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Mode_log.n_tot_ncs Mode_log.oc Mode_log.p_mehlich3 Mode_log.s_mehlich3</span></span>
<span id="cb13-207"><a href="#cb13-207" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:                 55          21                  18                  34</span></span>
<span id="cb13-208"><a href="#cb13-208" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:                 44          16                  16                  19</span></span>
<span id="cb13-209"><a href="#cb13-209" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Mode_ph_h2o Mode_sand_tot_psa Mode_silt_tot_psa Mode_texture.class</span></span>
<span id="cb13-210"><a href="#cb13-210" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:          56                52                21                  6</span></span>
<span id="cb13-211"><a href="#cb13-211" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:          56                55                19                  6</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
